<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login Page</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script src="myresume.js" type="text/javaScript"></script>
    <link href="login.css" rel="stylesheet">
</head>
<body>
    <div class="main">
        
        <div class="container">
            <div class="heading">
                <h1 style="text-align: center;">Login</h1>
           </div>
           <table>
            <tbody>
            <div class="input">
                 <tr><td >Enter your Email:</td><td><input type="email"  onkeyup="log(this, 'log_email')" id="log_email" placeholder="Enter Your Email"></td></tr>
            </div>
           
            <div class="input">
                <tr><td>Enter your Password:</td><td><input type="password"  onkeyup="log(this, 'log_password')" id="log_password" placeholder="Enter Your Password" ></td></tr>
               
           </div>

            </tbody>
            </table>
            <div class="invalid_alert" id="invalid_alert">
                <h3 style="color: red; font-size:medium;">*Please Enter Valid Email & Password</h3>
            </div>
            <div class="login_footer">
               
                
                <div class="button">
                    <button type="button" id="loginusers" >Login</button>
                </div>
                
            </div>
            <div>
                    <h2 class="register">Already have an account? <a href="register.html">Create New </a> </h2>
            </div>
           >
        </div>
        </div>
    </div>
</body>
<script>

function registernew(){
    window.location="register.html"
}

</script>

</html>


<script type="module">
    // Import the functions you need from the SDKs you need
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.9.0/firebase-app.js";
    import { getFirestore,collection,addDoc,deleteDoc,updateDoc,getDoc,getDocs,doc ,query,where } from "https://www.gstatic.com/firebasejs/10.9.0/firebase-firestore.js";
    // TODO: Add SDKs for Firebase products that you want to use
    // https://firebase.google.com/docs/web/setup#available-libraries
  
    // Your web app's Firebase configuration
    const firebaseConfig = {
      apiKey: "AIzaSyD4Hsq2GiOH1YrneWOSBAazh_pMZBoNhUQ",
      authDomain: "resumebuilder-a39bb.firebaseapp.com",
      projectId: "resumebuilder-a39bb",
      storageBucket: "resumebuilder-a39bb.appspot.com",
      messagingSenderId: "842904588733",
      appId: "1:842904588733:web:ded89179b09898e2a742d4"
    };
  
    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);


   

getDocs(collection(db, "userslist")).then(docSnap =>{
    let user=[];
        docSnap.forEach((doc) => {
        user.push({...doc.data(),id:doc.id})
       })

let datas=[];
       for (let each of user){
        datas.push(each)
       }

        document.getElementById("loginusers").addEventListener("click", async (e) =>{
        const docRef=await addDoc(collection(db,"logindatas"),logindata);

       let logemail=document.getElementById("log_email").value
       let logpassword=document.getElementById("log_password").value


       if (logpassword=== '' || logemail=== ''  ){
            
            window.location.reload()

           alert("please fill  both Email and Password")
        }
        else{
           
            
           let store_mail="";
           let store_pass="";
           let store_id="";
           let store_name="";
                for (let each in datas){
               
                    
                    if (logemail===datas[each]["email"] && logpassword===datas[each]["password"]){
                        store_mail=datas[each]["email"]
                        store_pass=datas[each]["password"] 
                        store_id=datas[each]["id"]
                        store_name=datas[each]["name"]


                        if (store_mail===logemail && store_pass===logpassword){

                                let local_storage={"id":store_id,
                                                "name":store_name}

                                let local=JSON.stringify(local_storage)
                                localStorage.setItem("login_credentials",local)
                               
                        }
                        
                      }
                     
                    
                    }
                            if (store_mail==logemail && store_pass==logpassword){

                               
                                 window.location=`resumelist.html?firebaseid=${store_id}`
                            }
                            
                            else {


                                alert("Your data is not valid please Check")
                                window.location.reload()
                            }    
                            
                
                }
                   
                           
                           

            
          
        
    });
 

})
</script>
